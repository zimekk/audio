"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[843],{2843:(e,t,n)=>{n.r(t),n.d(t,{default:()=>G});var o=n(2784),r=n(3752),a=n(1148),l=n(2779),s=n.n(l),c=n(2144);const i=Object.entries({C5:"a","C#5":"w",D5:"s","D#5":"e",E5:"d",F5:"f","F#5":"t",G5:"g","G#5":"y",A5:"h","A#5":"u",B5:"j",C6:"k","C#6":"o",D6:"l","D#6":"p",E6:";",F6:"'"}).reduce(((e,[t,n])=>Object.assign(e,{[r.mb(t).transpose(-24).toNote()]:n})),{}),p=()=>{const[e,t]=(0,o.useState)((()=>[])),n=Object.entries(i).reduce(((e,[t,n])=>Object.assign(e,{[{";":"Semicolon","'":"Quote"}[n]||`Key${n.toUpperCase()}`]:t})),{});return(0,o.useEffect)((()=>{const e=e=>n[e.code]&&t((t=>t.concat(n[e.code]))),o=e=>n[e.code]&&t((t=>t.filter((t=>t!==n[e.code]))));return document.addEventListener("keydown",e),document.addEventListener("keyup",o),()=>{document.removeEventListener("keydown",e),document.removeEventListener("keyup",o)}}),[t]),e};function d({note:e,keyDown:t,keyUp:n,pressed:r}){const[{enter:a,press:l},p]=(0,o.useState)({enter:!1,press:!1}),d=(0,o.useMemo)((()=>r||a&&l),[a,l,r]);return(0,o.useEffect)((()=>d?t(e):n(e)),[d]),e?o.createElement("span",{className:s()(c.Z.Note,d&&c.Z.pressed),onMouseEnter:e=>p((t=>({...t,enter:!0,press:!!e.buttons}))),onMouseLeave:()=>p((e=>({...e,enter:!1}))),onMouseDown:e=>(e.preventDefault(),p((e=>({...e,press:!0})))),onMouseUp:()=>p((e=>({...e,press:!1})))},i[e]&&o.createElement("i",null,i[e]),e):o.createElement("span",{className:c.Z.Space})}function u({octave:e=1,keys:t,keyDown:n,keyUp:a}){const l=12*e,s=[0,2,4,5,7,9,11].map((e=>e+l)),i=[0,1,3,0,6,8,10,0].map((e=>e?e+l:0));return o.createElement("div",{className:c.Z.Octave},o.createElement("div",{className:c.Z.WhiteNotes},s.map((e=>r.mb(e).toNote())).map(((e,r)=>o.createElement(d,{key:r,note:e,keyDown:n,keyUp:a,pressed:t.includes(e)})))),o.createElement("div",{className:c.Z.BlackNotes},i.map((e=>e&&r.mb(e).toNote())).map(((e,r)=>o.createElement(d,{key:r,note:e,keyDown:n,keyUp:a,pressed:t.includes(e)})))))}function m({rootoctave:e=4,octaves:t=4,keyDown:n,keyUp:r,pressed:a}){const l=p();return o.createElement("div",{className:c.Z.Keyboard},[...Array(t)].map(((t,n)=>n+e)).map(((e,t)=>o.createElement(u,{key:t,octave:e,keys:l.concat(a),keyDown:n,keyUp:r}))))}var f=n(3919),b=n(5120),k=n(8025),g=n(9054),x=n(7984),w=n(2636),y=n(8795),v=n(8788),E=n(2423),h=n(357);const O=(e,t=12)=>{return e+((n=e+7)-n%t)/t+(e=>(e-e%t)/t)(e);var n},F=[n(8065).Z,n(9205).Z,n(9342).Z,n(4316).Z],C=(0,h.k)((async e=>{try{return await E.Midi.fromUrl(e)}catch(e){return console.error(e),{name:e.message,duration:0,durationTicks:0,tracks:[{notes:[]}]}}}));function U({note:e,durationTicks:t,notes$:n}){return o.createElement("button",{className:s()(c.Z.RollNote,e.name.match(/#/)&&c.Z.sharp),style:{position:"absolute",top:(t-e.ticks-e.durationTicks)/10+"px",left:`${O(e.midi-48)}em`,height:e.durationTicks/10+"px"},onMouseDown:t=>(t.preventDefault(),n.next([e]))},o.createElement("span",null,e.name))}function _({notes$:e}){const[t,n]=(0,o.useState)((()=>F)),[r,l]=(0,o.useState)((()=>t[0])),{name:s,duration:i,durationTicks:p,tracks:d}=C.read(r),[u,m]=(0,o.useState)(0),[E,h]=(0,o.useState)(1),[O,_]=(0,o.useState)(!1),G=(0,o.useRef)(E),A=(0,o.useRef)(null),D=(0,o.useMemo)((()=>new a.x),[]),N=(0,o.useMemo)((()=>new a.x),[]),T=(0,o.useMemo)((()=>(0,b.of)(void 0).pipe((0,k.j)((e=>{return t=e,f.y.create((e=>{requestAnimationFrame((n=>{const o=t?(n-t.frameStartTime)/1e3:0;e.next({frameStartTime:n,deltaTime:o})}))}));var t})),(0,g.h)((e=>void 0!==e)),(0,x.U)((e=>e.deltaTime)),(0,w.B)())),[]);console.log({name:s,duration:i,tracks:d});const{notes:Z}=(0,o.useMemo)((()=>d[u]),[d,u]);return(0,o.useEffect)((()=>{G.current=E}),[T,G,E]),(0,o.useEffect)((()=>{const e=T.pipe((0,y.M)(D),(0,g.h)((([e,t])=>t))).subscribe((()=>{if(A.current){const e=A.current;e.scrollTop>0?e.scrollTop-=G.current:D.next(!1)}}));return()=>e.unsubscribe()}),[T,G]),(0,o.useEffect)((()=>{const t=N.pipe((0,x.U)((e=>e.scrollTop)),(0,v.G)(),(0,x.U)((([e,t])=>Z.filter((n=>{return o=(p-n.ticks)/10,t<=o&&o<e;var o}))))).subscribe((t=>e.next(t)));return()=>t.unsubscribe()}),[N,e,Z,p]),(0,o.useEffect)((()=>{const e=D.subscribe((e=>{const t=A.current;e&&t&&0===t.scrollTop&&(t.scrollTop=t.scrollHeight),_(e)}));return()=>e.unsubscribe()}),[D]),o.createElement("div",null,o.createElement("fieldset",null,o.createElement("div",null,o.createElement("label",null,o.createElement("span",null,"Midi"),o.createElement("select",{value:r,onChange:(0,o.useCallback)((({target:e})=>(l(e.value),m(0))),[])},t.map(((e,t)=>o.createElement("option",{key:t,value:e},e))))),o.createElement("button",{onClick:e=>(e.stopPropagation(),(e=>e?.match(/.+$/)&&(n((t=>t.concat(e))),l(e),m(0)))(prompt("Midi file URL","https://www.midiworld.com/download/3731")))},"add")),o.createElement("div",null,o.createElement("label",null,o.createElement("span",null,"Track"),o.createElement("select",{value:u,onChange:(0,o.useCallback)((({target:e})=>m(Number(e.value))),[])},d.map((({name:e},t)=>o.createElement("option",{key:t,value:t},e)))))),o.createElement("div",null,o.createElement("label",null,o.createElement("span",null,"Speed"),o.createElement("select",{value:E,onChange:(0,o.useCallback)((({target:e})=>h(Number(e.value))),[])},[1,2,3,4].map(((e,t)=>o.createElement("option",{key:t,value:e},e))))),O?o.createElement("button",{onClick:e=>(e.stopPropagation(),D.next(!1))},"stop"):o.createElement("button",{onClick:e=>(e.stopPropagation(),D.next(!0))},"play"))),o.createElement("div",{ref:A,className:c.Z.Roll,onScroll:(0,o.useCallback)((({target:e})=>N.next(e)),[])},o.createElement("div",{className:c.Z.Inner,style:{height:p/10+"px"}},Z.map(((t,n)=>o.createElement(U,{key:n,note:t,durationTicks:p,notes$:e}))))))}function G(){const e=(0,o.useMemo)((()=>new a.x),[]),[t,n]=(0,o.useState)((()=>[])),l=(()=>{const[e]=(0,o.useState)((()=>new r.Z4({urls:{A0:"A0.mp3",C1:"C1.mp3","D#1":"Ds1.mp3","F#1":"Fs1.mp3",A1:"A1.mp3",C2:"C2.mp3","D#2":"Ds2.mp3","F#2":"Fs2.mp3",A2:"A2.mp3",C3:"C3.mp3","D#3":"Ds3.mp3","F#3":"Fs3.mp3",A3:"A3.mp3",C4:"C4.mp3","D#4":"Ds4.mp3","F#4":"Fs4.mp3",A4:"A4.mp3",C5:"C5.mp3","D#5":"Ds5.mp3","F#5":"Fs5.mp3",A5:"A5.mp3",C6:"C6.mp3","D#6":"Ds6.mp3","F#6":"Fs6.mp3",A6:"A6.mp3",C7:"C7.mp3","D#7":"Ds7.mp3","F#7":"Fs7.mp3",A7:"A7.mp3",C8:"C8.mp3"},release:1,baseUrl:"https://tonejs.github.io/audio/salamander/",onload:()=>{}}).toDestination()));return e})(),s=(0,o.useCallback)((e=>l.triggerAttack(e)),[l]),c=(0,o.useCallback)((e=>l.triggerRelease(e)),[l]);return(0,o.useEffect)((()=>{const t=e.subscribe((e=>{return t=r.zO(),e.forEach((e=>{l.triggerAttackRelease(e.name,e.duration,t,e.velocity),r.hG.schedule((()=>{n((t=>t.concat(e.name)))}),t),r.hG.schedule((()=>{n((t=>t.filter((t=>t!==e.name))))}),t+e.duration)}));var t}));return()=>t.unsubscribe()}),[e,n]),o.createElement("div",null,"Piano",o.createElement(_,{notes$:e}),o.createElement(m,{keyDown:s,keyUp:c,pressed:t}))}},8143:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var o=n(9601),r=n.n(o),a=n(2609),l=n.n(a),s=n(8991),c=n.n(s),i=new URL(n(3715),n.b),p=l()(r()),d=c()(i);p.push([e.id,".tl_c1qJYTb5yZEiHwKkb{border:1px solid #d3d3d3;padding:0;outline:none;transition:background-color .2s;border-radius:2px;font-size:9px}.tl_c1qJYTb5yZEiHwKkb:focus{border-color:gray}.xedOmG_wUpF499FfpxBO{display:flex;position:relative}.xedOmG_wUpF499FfpxBO .tl_c1qJYTb5yZEiHwKkb,.xedOmG_wUpF499FfpxBO .vEdUZpIgLUgprvHGy89e{display:flex;flex:1;flex-direction:column}.xedOmG_wUpF499FfpxBO .tl_c1qJYTb5yZEiHwKkb{z-index:1;align-items:center;justify-content:end;font-family:Arial;font-size:9px}.xedOmG_wUpF499FfpxBO .tl_c1qJYTb5yZEiHwKkb i{margin:.5em 0;font-size:larger;font-weight:bold}.xedOmG_wUpF499FfpxBO .vEdUZpIgLUgprvHGy89e{pointer-events:none}.xedOmG_wUpF499FfpxBO .vEdUZpIgLUgprvHGy89e:first-of-type,.xedOmG_wUpF499FfpxBO .vEdUZpIgLUgprvHGy89e:last-of-type{flex-grow:.5}.xedOmG_wUpF499FfpxBO .MTvQk2t6H4kpI9hiG0N0,.xedOmG_wUpF499FfpxBO .Y3ARd6LKLk7oRKYGHK5o{position:absolute;display:flex;flex-direction:row;flex-grow:1}.xedOmG_wUpF499FfpxBO .MTvQk2t6H4kpI9hiG0N0{width:100%;height:100%}.xedOmG_wUpF499FfpxBO .MTvQk2t6H4kpI9hiG0N0 .tl_c1qJYTb5yZEiHwKkb{background-color:#fff;color:#000}.xedOmG_wUpF499FfpxBO .MTvQk2t6H4kpI9hiG0N0 .tl_c1qJYTb5yZEiHwKkb.C1VXh_7oUTVqX2wuk8zM{border-color:red}.xedOmG_wUpF499FfpxBO .Y3ARd6LKLk7oRKYGHK5o{width:100%;height:55%}.xedOmG_wUpF499FfpxBO .Y3ARd6LKLk7oRKYGHK5o .tl_c1qJYTb5yZEiHwKkb{background-color:#000;color:#ccc}.xedOmG_wUpF499FfpxBO .Y3ARd6LKLk7oRKYGHK5o .tl_c1qJYTb5yZEiHwKkb.C1VXh_7oUTVqX2wuk8zM{border-color:red}._8DbB5CERGA5bp_CPPh5{display:flex;position:relative;top:-100px;height:0;background-color:#fff;opacity:.8}._8DbB5CERGA5bp_CPPh5 .xedOmG_wUpF499FfpxBO{flex-grow:1;height:80px}.to5WNLg1CzgQJEw4BWl7{position:relative;display:flex;flex-direction:row;width:100%;height:500px;overflow-y:scroll}.to5WNLg1CzgQJEw4BWl7 .YSOWVtYln3cyrrmD8Of_{position:absolute;font-size:1.7857142857vw;border:1px solid red;box-sizing:border-box;background:rgba(255,128,0,.2);color:red;opacity:.8;width:2em;margin:400px 0 0;padding:0;align-items:center;justify-content:center}.to5WNLg1CzgQJEw4BWl7 .YSOWVtYln3cyrrmD8Of_.xI2VmWOcs2MgyyQUklLA{background:rgba(255,0,0,.6);color:#fff}.to5WNLg1CzgQJEw4BWl7 .YSOWVtYln3cyrrmD8Of_:hover{opacity:1}.to5WNLg1CzgQJEw4BWl7 .YSOWVtYln3cyrrmD8Of_ span{font-family:Arial;font-size:9px}.to5WNLg1CzgQJEw4BWl7 .iNXp4jf9N6exbktzLAso{display:flex;flex-direction:column;padding:360px 0;flex-grow:1;background:#fff url("+d+");background-size:7.1428571429vw 72px}",""]),p.locals={Note:"tl_c1qJYTb5yZEiHwKkb",Octave:"xedOmG_wUpF499FfpxBO",Space:"vEdUZpIgLUgprvHGy89e",WhiteNotes:"MTvQk2t6H4kpI9hiG0N0",BlackNotes:"Y3ARd6LKLk7oRKYGHK5o",pressed:"C1VXh_7oUTVqX2wuk8zM",Keyboard:"_8DbB5CERGA5bp_CPPh5",Roll:"to5WNLg1CzgQJEw4BWl7",RollNote:"YSOWVtYln3cyrrmD8Of_",sharp:"xI2VmWOcs2MgyyQUklLA",Inner:"iNXp4jf9N6exbktzLAso"};const u=p},9342:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"875ae3b74407297f3a51860f1a0353b0.mid"},9205:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"d1861a6e2649b4f97f31196829ac89c3.mid"},8065:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"cfe23cb6e3ba37bfbe92a47c5926047e.mid"},4316:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"95667c35c56500a40d9f72c749159ff3.mid"},2144:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(6062),r=n.n(o),a=n(4036),l=n.n(a),s=n(6793),c=n.n(s),i=n(7892),p=n.n(i),d=n(1173),u=n.n(d),m=n(2464),f=n.n(m),b=n(8143),k={};k.styleTagTransform=f(),k.setAttributes=p(),k.insert=c().bind(null,"head"),k.domAPI=l(),k.insertStyleElement=u();var g=r()(b.default,k);if(!b.default.locals||e.hot.invalidate){var x=!b.default.locals,w=x?b:b.default.locals;e.hot.accept(8143,(t=>{b=n(8143),function(e,t,n){if(!e&&t||e&&!t)return!1;var o;for(o in e)if((!n||"default"!==o)&&e[o]!==t[o])return!1;for(o in t)if(!(n&&"default"===o||e[o]))return!1;return!0}(w,x?b:b.default.locals,x)?(w=x?b:b.default.locals,g(b.default)):e.hot.invalidate()}))}e.hot.dispose((function(){g()}));const y=b.default&&b.default.locals?b.default.locals:void 0},3715:e=>{e.exports='data:image/svg+xml,        <svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" fill-opacity=".05" >        <rect x="100" width="100" height="100" />        <rect y="100" width="100" height="100" />        </svg>'}}]);