"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[734],{734:(e,t,n)=>{n.r(t),n.d(t,{default:()=>F});var o=n(2784),r=n(3752),a=n(2423),l=n(3919),s=n(1148),c=n(5120),i=n(8025),d=n(9054),p=n(7984),u=n(2636),m=n(8795),f=n(8788),g=n(357),b=n(2779),y=n.n(b),v=n(2144);const x=Object.entries({C5:"a","C#5":"w",D5:"s","D#5":"e",E5:"d",F5:"f","F#5":"t",G5:"g","G#5":"y",A5:"h","A#5":"u",B5:"j",C6:"k","C#6":"o",D6:"l","D#6":"p",E6:";",F6:"'"}).reduce(((e,[t,n])=>Object.assign(e,{[r.mb(t).transpose(-24).toNote()]:n})),{}),h=(0,g.k)((async()=>await a.Midi.fromUrl(n(8065).Z)));function k({note:e,color:t,synth:n}){return e?o.createElement("button",{className:v.Z.Note,style:{background:t,color:"black"===t?"#ccc":"black"},onMouseDown:t=>n.triggerAttack(e),onMouseUp:t=>n.triggerRelease(e)},x[e]&&o.createElement("i",null,x[e]),e):o.createElement("span",{className:v.Z.Space})}function w({octave:e=1,synth:t}){const n=12*e,a=[0,2,4,5,7,9,11].map((e=>e+n)),l=[0,1,3,0,6,8,10,0].map((e=>e?e+n:0));return o.createElement("div",{className:v.Z.Octave},o.createElement("div",{className:v.Z.WhiteNotes},a.map((e=>r.mb(e).toNote())).map(((e,n)=>o.createElement(k,{key:n,color:"white",note:e,synth:t})))),o.createElement("div",{className:v.Z.BlackNotes},l.map((e=>e&&r.mb(e).toNote())).map(((e,n)=>o.createElement(k,{key:n,color:"black",note:e,synth:t})))))}function E({rootoctave:e=4,octaves:t=4,synth:n}){return o.createElement("div",{className:v.Z.Keyboard},[...Array(t)].map(((t,n)=>n+e)).map(((e,t)=>o.createElement(w,{key:t,octave:e,synth:n}))))}const O=(e,t=12)=>{return e+((n=e+7)-n%t)/t+(e=>(e-e%t)/t)(e);var n};function N({note:e,synth:t}){return o.createElement("button",{className:y()(v.Z.RollNote,e.name.match(/#/)&&v.Z.sharp),style:{position:"absolute",top:(e.ticks-e.durationTicks)/10+"px",left:`${O(e.midi-48)}em`,height:e.durationTicks/10+"px"},onMouseDown:n=>{return n.preventDefault(),o=r.zO(),t.triggerAttackRelease(e.name,e.duration,o,e.velocity);var o}},o.createElement("span",null,e.name))}function _({synth:e}){const{name:t,duration:n,durationTicks:a,tracks:g}=h.read(),[b,y]=(0,o.useState)(0),[x,k]=(0,o.useState)(!1),w=(0,o.useRef)(null),E=(0,o.useMemo)((()=>new s.x),[]),O=(0,o.useMemo)((()=>new s.x),[]),_=(0,o.useMemo)((()=>(0,c.of)(void 0).pipe((0,i.j)((e=>{return t=e,l.y.create((e=>{requestAnimationFrame((n=>{const o=t?(n-t.frameStartTime)/1e3:0;e.next({frameStartTime:n,deltaTime:o})}))}));var t})),(0,d.h)((e=>void 0!==e)),(0,p.U)((e=>e.deltaTime)),(0,u.B)())),[]);console.log({name:t,duration:n,tracks:g});const{notes:F}=(0,o.useMemo)((()=>g[b]),[g,b]);return(0,o.useEffect)((()=>{const e=_.pipe((0,m.M)(E),(0,d.h)((([e,t])=>t))).subscribe((()=>{if(w.current){const e=w.current;e.scrollTop>0?e.scrollTop-=2:E.next(!1)}}));return()=>e.unsubscribe()}),[_]),(0,o.useEffect)((()=>{const t=O.pipe((0,p.U)((e=>e.scrollTop)),(0,f.G)(),(0,p.U)((([e,t])=>F.filter((n=>{return o=n.ticks/10,t<=o&&o<e;var o}))))).subscribe((t=>{return n=r.zO(),t.forEach((t=>e.triggerAttackRelease(t.name,t.duration,n,t.velocity)));var n}));return()=>t.unsubscribe()}),[O]),(0,o.useEffect)((()=>{const e=E.subscribe((e=>{const t=w.current;e&&t&&0===t.scrollTop&&(t.scrollTop=t.scrollHeight),k(e)}));return()=>e.unsubscribe()}),[E]),o.createElement("div",null,o.createElement("fieldset",null,o.createElement("label",null,o.createElement("span",null,"Track"),o.createElement("select",{value:b,onChange:(0,o.useCallback)((({target:e})=>y(Number(e.value))),[])},g.map((({name:e},t)=>o.createElement("option",{key:t,value:t},e))))),x?o.createElement("button",{onClick:e=>(e.stopPropagation(),E.next(!1))},"stop"):o.createElement("button",{onClick:e=>(e.stopPropagation(),E.next(!0))},"play")),o.createElement("div",{ref:w,className:v.Z.Roll,onScroll:(0,o.useCallback)((({target:e})=>O.next(e)),[])},o.createElement("div",{className:v.Z.Inner,style:{height:a/10+"px"}},F.map(((t,n)=>o.createElement(N,{key:n,note:t,synth:e}))))))}function F(){const e=(()=>{const[e]=(0,o.useState)((()=>new r.v2(r.op,{volume:-8,oscillator:{type:"square8"},envelope:{attack:.05,decay:.3,sustain:.4,release:.8},filterEnvelope:{attack:.001,decay:.7,sustain:.1,release:.8,baseFrequency:300,octaves:4}}).toDestination()));return e})();return(e=>{const t=Object.entries(x).reduce(((e,[t,n])=>Object.assign(e,{[{";":"Semicolon","'":"Quote"}[n]||`Key${n.toUpperCase()}`]:t})),{});(0,o.useEffect)((()=>{const n=n=>t[n.code]&&e.triggerAttack(t[n.code]),o=n=>t[n.code]&&e.triggerRelease(t[n.code]);return document.addEventListener("keydown",n),document.addEventListener("keyup",o),()=>{document.removeEventListener("keydown",n),document.removeEventListener("keyup",o)}}),[])})(e),o.createElement("div",null,"Piano",o.createElement(_,{synth:e}),o.createElement(E,{synth:e}),o.createElement("div",null,o.createElement("a",{href:"#"},"https://musiclab.chromeexperiments.com/Shared-Piano/"),o.createElement("a",{href:"#"},"https://github.com/Monika-After-Story/MonikaModDev/issues/5712")))}},8143:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u});var o=n(9601),r=n.n(o),a=n(2609),l=n.n(a),s=n(8991),c=n.n(s),i=new URL(n(3715),n.b),d=l()(r()),p=c()(i);d.push([e.id,".tl_c1qJYTb5yZEiHwKkb{border:1px solid #d3d3d3;padding:0;outline:none;transition:background-color .2s;border-radius:2px;font-size:9px}.tl_c1qJYTb5yZEiHwKkb:focus{border-color:gray}.xedOmG_wUpF499FfpxBO{display:flex;position:relative}.xedOmG_wUpF499FfpxBO .tl_c1qJYTb5yZEiHwKkb,.xedOmG_wUpF499FfpxBO .vEdUZpIgLUgprvHGy89e{display:flex;flex:1;flex-direction:column}.xedOmG_wUpF499FfpxBO .tl_c1qJYTb5yZEiHwKkb{z-index:1;align-items:center;justify-content:end}.xedOmG_wUpF499FfpxBO .tl_c1qJYTb5yZEiHwKkb i{margin:.5em 0;font-size:larger;font-weight:bold}.xedOmG_wUpF499FfpxBO .vEdUZpIgLUgprvHGy89e{pointer-events:none}.xedOmG_wUpF499FfpxBO .vEdUZpIgLUgprvHGy89e:first-of-type,.xedOmG_wUpF499FfpxBO .vEdUZpIgLUgprvHGy89e:last-of-type{flex-grow:.5}.xedOmG_wUpF499FfpxBO .MTvQk2t6H4kpI9hiG0N0,.xedOmG_wUpF499FfpxBO .Y3ARd6LKLk7oRKYGHK5o{position:absolute;display:flex;flex-direction:row;flex-grow:1}.xedOmG_wUpF499FfpxBO .MTvQk2t6H4kpI9hiG0N0{width:100%;height:100%}.xedOmG_wUpF499FfpxBO .Y3ARd6LKLk7oRKYGHK5o{width:100%;height:55%}._8DbB5CERGA5bp_CPPh5{display:flex;position:relative;top:-100px;height:0;background-color:#fff;opacity:.8}._8DbB5CERGA5bp_CPPh5 .xedOmG_wUpF499FfpxBO{flex-grow:1;height:80px}.to5WNLg1CzgQJEw4BWl7{position:relative;display:flex;flex-direction:row;width:100%;height:500px;overflow-y:scroll}.to5WNLg1CzgQJEw4BWl7 .YSOWVtYln3cyrrmD8Of_{position:absolute;font-size:1.7857142857vw;border:1px solid red;box-sizing:border-box;background:rgba(255,0,0,.6);opacity:.8;color:#fff;width:2em;margin:400px 0 0;padding:0;align-items:center;justify-content:center}.to5WNLg1CzgQJEw4BWl7 .YSOWVtYln3cyrrmD8Of_.xI2VmWOcs2MgyyQUklLA{background:rgba(255,128,0,.2);color:red}.to5WNLg1CzgQJEw4BWl7 .YSOWVtYln3cyrrmD8Of_:hover{opacity:1}.to5WNLg1CzgQJEw4BWl7 .YSOWVtYln3cyrrmD8Of_ span{font-family:Arial;font-size:9px}.to5WNLg1CzgQJEw4BWl7 .iNXp4jf9N6exbktzLAso{display:flex;flex-direction:column;padding:360px 0;flex-grow:1;background:#fff url("+p+");background-size:7.1428571429vw 72px}",""]),d.locals={Note:"tl_c1qJYTb5yZEiHwKkb",Octave:"xedOmG_wUpF499FfpxBO",Space:"vEdUZpIgLUgprvHGy89e",WhiteNotes:"MTvQk2t6H4kpI9hiG0N0",BlackNotes:"Y3ARd6LKLk7oRKYGHK5o",Keyboard:"_8DbB5CERGA5bp_CPPh5",Roll:"to5WNLg1CzgQJEw4BWl7",RollNote:"YSOWVtYln3cyrrmD8Of_",sharp:"xI2VmWOcs2MgyyQUklLA",Inner:"iNXp4jf9N6exbktzLAso"};const u=d},8065:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n.p+"cfe23cb6e3ba37bfbe92a47c5926047e.mid"},2144:(e,t,n)=>{n.d(t,{Z:()=>h});var o=n(6062),r=n.n(o),a=n(4036),l=n.n(a),s=n(6793),c=n.n(s),i=n(7892),d=n.n(i),p=n(1173),u=n.n(p),m=n(2464),f=n.n(m),g=n(8143),b={};b.styleTagTransform=f(),b.setAttributes=d(),b.insert=c().bind(null,"head"),b.domAPI=l(),b.insertStyleElement=u();var y=r()(g.default,b);if(!g.default.locals||e.hot.invalidate){var v=!g.default.locals,x=v?g:g.default.locals;e.hot.accept(8143,(t=>{g=n(8143),function(e,t,n){if(!e&&t||e&&!t)return!1;var o;for(o in e)if((!n||"default"!==o)&&e[o]!==t[o])return!1;for(o in t)if(!(n&&"default"===o||e[o]))return!1;return!0}(x,v?g:g.default.locals,v)?(x=v?g:g.default.locals,y(g.default)):e.hot.invalidate()}))}e.hot.dispose((function(){y()}));const h=g.default&&g.default.locals?g.default.locals:void 0},3715:e=>{e.exports='data:image/svg+xml,        <svg xmlns="http://www.w3.org/2000/svg" width="200" height="200" fill-opacity=".05" >        <rect x="100" width="100" height="100" />        <rect y="100" width="100" height="100" />        </svg>'}}]);