"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[342],{9849:(e,t,n)=>{n.d(t,{u:()=>c});var l=n(2784),r=n(1718),a=n(3100);const o=window.AudioContext||window.webkitAudioContext,s=(e,t,n,l,r)=>{e.lineWidth=1,e.strokeStyle="#94b398",e.beginPath(),n=r?n:-n,e.moveTo(t,0),e.lineTo(t,n),e.arc(t+l/2,n,l/2,Math.PI,0,r),e.lineTo(t+l,0),e.stroke()};function c({src:e,progress:t}){const n=(0,l.useRef)(null);return(0,l.useEffect)((()=>{const t=new o;fetch(e).then((e=>e.arrayBuffer())).then((e=>(0,r.kS)(t,e))).then((e=>((e,t,n=window.devicePixelRatio||1)=>{e.width=e.offsetWidth*n,e.height=(e.offsetHeight+40)*n;const l=e.getContext("2d");l.scale(n,n),l.translate(0,e.offsetHeight/2+20);const r=e.offsetWidth/t.length;for(let n=0;n<t.length;n++){const a=r*n;let o=t[n]*e.offsetHeight-20;o<0?o=0:o>e.offsetHeight/2&&(o=o>e.offsetHeight/2),s(l,a,o,r,(n+1)%2)}})(n.current,(e=>{const t=Math.pow(Math.max(...e),-1);return e.map((e=>e*t))})((e=>{const t=e.getChannelData(0),n=Math.floor(t.length/250),l=[];for(let e=0;e<250;e++){let r=n*e,a=0;for(let e=0;e<n;e++)a+=Math.abs(t[r+e]);l.push(a/n)}return l})(e))))).catch(console.error)}),[e]),l.createElement("div",{className:a.Z.Waveform},l.createElement("div",{className:a.Z.Progress,style:{width:100*t+"%"}}),l.createElement("canvas",{ref:n}))}},6342:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b});var l=n(2784),r=n(9477),a=n.n(r),o=n(1718),s=n(3738);const c=window.AudioContext||window.webkitAudioContext;function i({src:e,progress:t}){const[n,r]=(0,l.useState)(null);return(0,l.useEffect)((()=>{const t=new c;fetch(e).then((e=>e.arrayBuffer())).then((e=>(0,o.kS)(t,e))).then((e=>{const t=function(e){for(var t=22050,n=e[0].length/t,l=[],r=0;r<n;r++){for(var a=0,o=r*t;o<(r+1)*t;o++){var s=Math.max(Math.abs(e[0][o]),Math.abs(e[1][o]));(!a||s>a.volume)&&(a={position:o,volume:s})}l.push(a)}return l.sort((function(e,t){return t.volume-e.volume})),(l=l.splice(0,.5*l.length)).sort((function(e,t){return e.position-t.position})),l}([e.getChannelData(0),e.getChannelData(1)]),n=function(e){var t=[];return e.forEach((function(n,l){for(var r=1;l+r<e.length&&r<10;r++){for(var a={tempo:2646e3/(e[l+r].position-n.position),count:1};a.tempo<90;)a.tempo*=2;for(;a.tempo>180;)a.tempo/=2;a.tempo=Math.round(a.tempo),t.some((function(e){return e.tempo===a.tempo?e.count++:0}))||t.push(a)}})),t}(t);console.log({peaks:t,groups:n});const l=n.sort(((e,t)=>t.count-e.count)).splice(0,5);console.log(`Guess for track ${Math.round(l[0].tempo)} BPM with ${l[0].count} samples`),console.log(`Other options are ${l.slice(1).map((e=>`${e.tempo} BPM (${e.count})`)).join(", ")}`),r(t.map((({position:t})=>100*t/e.length+"%")))})).catch(console.error)}),[e]),l.createElement("div",{className:s.Z.Beats},l.createElement("div",{className:s.Z.Progress,style:{width:100*t+"%"}}),l.createElement("svg",{width:"100%"},n?.map(((e,t)=>l.createElement("rect",{key:t,x:e,y:"10%",width:"1",height:"80%"}))),l.createElement("rect",{className:s.Z.ProgressBar,x:100*t+"%",y:"0",width:"1",height:"100%"})))}var u=n(35),d=n.n(u),f=n(5394),m=n.n(f);const p=window.AudioContext||window.webkitAudioContext;function h({src:e,progress:t}){const[n,r]=(0,l.useState)(""),a=(0,l.useRef)(null),c=(0,l.useRef)(null);return(0,l.useEffect)((()=>{const t=new p,n=c.current=d()(a.current,{audio:{enable:!0},colors:e=>{const t=new(m().scale)([[0,0,255,1],[0,255,255,1],[0,255,0,1],[255,255,0,1],[255,0,0,1]],[0,.15,.3,.5,.75]).domain([0,e]),n=[];for(let l=0;l<e;++l){const e=t(l);n.push(e.hex())}return n}});Object.assign(window,{spectro:n}),fetch(e).then((e=>e.arrayBuffer())).then((e=>(0,o.kS)(t,e))).then((e=>{n.connectSource(e,t),console.log({spectro:n})})).catch(console.error)}),[e]),(0,l.useEffect)((()=>{switch(n){case"playing":c.current[c.current._paused?"resume":"start"]();break;case"paused":c.current.pause()}}),[n]),l.createElement("div",{className:s.Z.Spectrogram},{"":l.createElement("button",{onClick:()=>r("playing")},"Play"),playing:l.createElement("button",{onClick:()=>r("paused")},"Pause"),paused:l.createElement("button",{onClick:()=>r("playing")},"Resume")}[n],l.createElement("div",{className:s.Z.Progress,style:{width:100*t+"%"}}),l.createElement("canvas",{ref:a,id:"canvas"}))}var v=n(9849);const g=new(a());function E({src:e}){const[t,n]=(0,l.useState)(0),r=(0,l.useRef)(),a=(0,l.useRef)();return(0,l.useEffect)((()=>{const e=r.current;function t(){e.paused||(e.duration&&n(e.currentTime/e.duration),a.current=requestAnimationFrame(t))}return e.addEventListener("play",t),e.addEventListener("playing",t),()=>{e.removeEventListener("play",t),e.removeEventListener("playing",t),cancelAnimationFrame(a.current)}}),[]),l.createElement("div",null,l.createElement("video",{ref:r,controls:!0,autoPlay:!1},l.createElement("source",{src:e,type:"audio/mpeg"})),l.createElement(h,{src:e,progress:t}),l.createElement(v.u,{src:e,progress:t}),l.createElement(i,{src:e,progress:t}))}function b(){const[e,t]=(0,l.useState)(null),[n,r]=(0,l.useState)("https://geo-samples.beatport.com/track/b0fa2729-248f-4fd8-8e7d-bd427c30919c.LOFI.mp3"),[a,o]=(0,l.useState)(null),[c,i]=(0,l.useState)(null),u=(0,l.useRef)(),d=(0,l.useRef)();return(0,l.useEffect)((()=>{e&&a&&(g.setAccessToken(e),g.searchTracks(a).then(i,console.error))}),[e,a]),l.createElement("div",{className:s.Z.Search},l.createElement("h2",null,"Search"),l.createElement("div",null,l.createElement("label",null,l.createElement("span",null,"Token"),l.createElement("input",{ref:d,defaultValue:"",onFocus:e=>e.target.select()})),l.createElement("button",{onClick:e=>fetch("https://spotify-web-api-token.herokuapp.com/token").then((e=>e.json())).then((({token:e})=>t(d.current.value=e)))},"Get")),l.createElement("div",null,l.createElement("label",null,l.createElement("span",null,"Query"),l.createElement("input",{ref:u,defaultValue:"artist:BeyoncÃ©"})),l.createElement("button",{onClick:e=>t(d.current.value.trim())||o(u.current.value.trim())},"Find")),n&&l.createElement(E,{key:n,src:n}),l.createElement("ul",null,c?.tracks?.items.map((({album:e,id:t,name:n,preview_url:a,type:o})=>l.createElement("li",{key:t},l.createElement("div",null,"id: ",o," ",t),l.createElement("div",null,"name: ",n),l.createElement("div",null,"preview_url:"," ",l.createElement("a",{href:a,onClick:e=>e.preventDefault()||r(a)},a)),(({artists:e,id:t,images:n,name:r,type:a})=>l.createElement("div",null,l.createElement("div",null,"id: ",a," ",t),l.createElement("div",null,"artists: ",e.map((({name:e})=>e)).join(", ")),l.createElement("div",null,"name: ",r),l.createElement("div",null,n.sort((({width:e},{width:t})=>e-t)).slice(0,1).map((({width:e,height:t,url:n},a)=>l.createElement("img",{key:a,src:n,width:e,height:t,alt:r}))))))(e))))),l.createElement("pre",null,JSON.stringify(c,null,2)))}},7789:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var l=n(9601),r=n.n(l),a=n(2609),o=n.n(a)()(r());o.push([e.id,".CKgSghNKpREBuzbA7Ykt{display:flex;flex-direction:column}.MN3HVNw04LViHBlky330{display:flex;flex-direction:row;margin:2rem;align-items:center}.WkiRKpF351IO1uxS5kA_{width:4em;height:4em;margin:1em;border:2px solid currentColor;border-radius:50%}.veOat6GMQHaV_OvPnyuJ{color:green}.w3mVggYuPlb6ubmpMj69{color:red}.MMKvc1s1Dmbxl193AhLd{flex:1;margin:1em;position:relative}.MMKvc1s1Dmbxl193AhLd canvas{display:block;width:100%;height:8em}.MMKvc1s1Dmbxl193AhLd .hQ3Xho1E4oM84JfXXQSA{position:absolute;z-index:-1;left:0;width:0;top:0;bottom:0;background-color:#d3d3d3}",""]),o.locals={Player:"CKgSghNKpREBuzbA7Ykt",Container:"MN3HVNw04LViHBlky330",Button:"WkiRKpF351IO1uxS5kA_",Button__Play:"veOat6GMQHaV_OvPnyuJ",Button__Stop:"w3mVggYuPlb6ubmpMj69",Waveform:"MMKvc1s1Dmbxl193AhLd",Progress:"hQ3Xho1E4oM84JfXXQSA"};const s=o},204:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var l=n(9601),r=n.n(l),a=n(2609),o=n.n(a)()(r());o.push([e.id,".lfeSvZW11NcsdblvlBkp{display:flex;flex-direction:column}.uR71kJYLVWgDGlNf64Vl{flex:1;margin:1em;position:relative}.uR71kJYLVWgDGlNf64Vl canvas{display:block;width:100%;height:8em}.uR71kJYLVWgDGlNf64Vl .F0CuPTVNlnd9xRr0meI0{position:absolute;z-index:-1;left:0;width:0;top:0;bottom:0;background-color:#d3d3d3}.vx6pGbp7BjnjJLBxpT0i{flex:1;margin:1em;position:relative}.vx6pGbp7BjnjJLBxpT0i svg{display:block;width:100%;height:8em}.vx6pGbp7BjnjJLBxpT0i svg .oDtmvHDnFFt7VpBU7yls{fill:red}.vx6pGbp7BjnjJLBxpT0i .F0CuPTVNlnd9xRr0meI0{position:absolute;z-index:-1;left:0;width:0;top:0;bottom:0;background-color:#d3d3d3}",""]),o.locals={Search:"lfeSvZW11NcsdblvlBkp",Spectrogram:"uR71kJYLVWgDGlNf64Vl",Progress:"F0CuPTVNlnd9xRr0meI0",Beats:"vx6pGbp7BjnjJLBxpT0i",ProgressBar:"oDtmvHDnFFt7VpBU7yls"};const s=o},3100:(e,t,n)=>{n.d(t,{Z:()=>w});var l=n(6062),r=n.n(l),a=n(4036),o=n.n(a),s=n(6793),c=n.n(s),i=n(7892),u=n.n(i),d=n(1173),f=n.n(d),m=n(2464),p=n.n(m),h=n(7789),v={};v.styleTagTransform=p(),v.setAttributes=u(),v.insert=c().bind(null,"head"),v.domAPI=o(),v.insertStyleElement=f();var g=r()(h.default,v);if(!h.default.locals||e.hot.invalidate){var E=!h.default.locals,b=E?h:h.default.locals;e.hot.accept(7789,(t=>{h=n(7789),function(e,t,n){if(!e&&t||e&&!t)return!1;var l;for(l in e)if((!n||"default"!==l)&&e[l]!==t[l])return!1;for(l in t)if(!(n&&"default"===l||e[l]))return!1;return!0}(b,E?h:h.default.locals,E)?(b=E?h:h.default.locals,g(h.default)):e.hot.invalidate()}))}e.hot.dispose((function(){g()}));const w=h.default&&h.default.locals?h.default.locals:void 0},3738:(e,t,n)=>{n.d(t,{Z:()=>w});var l=n(6062),r=n.n(l),a=n(4036),o=n.n(a),s=n(6793),c=n.n(s),i=n(7892),u=n.n(i),d=n(1173),f=n.n(d),m=n(2464),p=n.n(m),h=n(204),v={};v.styleTagTransform=p(),v.setAttributes=u(),v.insert=c().bind(null,"head"),v.domAPI=o(),v.insertStyleElement=f();var g=r()(h.default,v);if(!h.default.locals||e.hot.invalidate){var E=!h.default.locals,b=E?h:h.default.locals;e.hot.accept(204,(t=>{h=n(204),function(e,t,n){if(!e&&t||e&&!t)return!1;var l;for(l in e)if((!n||"default"!==l)&&e[l]!==t[l])return!1;for(l in t)if(!(n&&"default"===l||e[l]))return!1;return!0}(b,E?h:h.default.locals,E)?(b=E?h:h.default.locals,g(h.default)):e.hot.invalidate()}))}e.hot.dispose((function(){g()}));const w=h.default&&h.default.locals?h.default.locals:void 0}}]);