"use strict";(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[342],{9849:(e,t,n)=>{n.d(t,{u:()=>i});var l=n(2784),a=n(1718),r=n(3100);const o=window.AudioContext||window.webkitAudioContext,s=(e,t,n,l,a)=>{e.lineWidth=1,e.strokeStyle="#94b398",e.beginPath(),n=a?n:-n,e.moveTo(t,0),e.lineTo(t,n),e.arc(t+l/2,n,l/2,Math.PI,0,a),e.lineTo(t+l,0),e.stroke()};function i({src:e,progress:t}){const n=(0,l.useRef)(null);return(0,l.useEffect)((()=>{const t=new o;fetch(e).then((e=>e.arrayBuffer())).then((e=>(0,a.kS)(t,e))).then((e=>console.log({audioBuffer:e})||((e,t,n=window.devicePixelRatio||1)=>{e.width=e.offsetWidth*n,e.height=(e.offsetHeight+40)*n;const l=e.getContext("2d");l.scale(n,n),l.translate(0,e.offsetHeight/2+20);const a=e.offsetWidth/t.length;for(let n=0;n<t.length;n++){const r=a*n;let o=t[n]*e.offsetHeight-20;o<0?o=0:o>e.offsetHeight/2&&(o=o>e.offsetHeight/2),s(l,r,o,a,(n+1)%2)}})(n.current,(e=>{const t=Math.pow(Math.max(...e),-1);return e.map((e=>e*t))})((e=>{const t=e.getChannelData(0),n=Math.floor(t.length/250),l=[];for(let e=0;e<250;e++){let a=n*e,r=0;for(let e=0;e<n;e++)r+=Math.abs(t[a+e]);l.push(r/n)}return l})(e))))).catch(console.error)}),[e]),l.createElement("div",{className:r.Z.Waveform},l.createElement("div",{className:r.Z.Progress,style:{width:100*t+"%"}}),l.createElement("canvas",{ref:n}))}},6342:(e,t,n)=>{n.r(t),n.d(t,{default:()=>E});var l=n(2784),a=n(9477),r=n.n(a),o=n(1718),s=n(3738);const i=window.AudioContext||window.webkitAudioContext;function c({src:e,progress:t}){const[n,a]=(0,l.useState)(null);return(0,l.useEffect)((()=>{const t=new i;fetch(e).then((e=>e.arrayBuffer())).then((e=>(0,o.kS)(t,e))).then((e=>{const t=function(e){for(var t=22050,n=e[0].length/t,l=[],a=0;a<n;a++){for(var r=0,o=a*t;o<(a+1)*t;o++){var s=Math.max(Math.abs(e[0][o]),Math.abs(e[1][o]));(!r||s>r.volume)&&(r={position:o,volume:s})}l.push(r)}return l.sort((function(e,t){return t.volume-e.volume})),(l=l.splice(0,.5*l.length)).sort((function(e,t){return e.position-t.position})),l}([e.getChannelData(0),e.getChannelData(1)]),n=function(e){var t=[];return e.forEach((function(n,l){for(var a=1;l+a<e.length&&a<10;a++){for(var r={tempo:2646e3/(e[l+a].position-n.position),count:1};r.tempo<90;)r.tempo*=2;for(;r.tempo>180;)r.tempo/=2;r.tempo=Math.round(r.tempo),t.some((function(e){return e.tempo===r.tempo?e.count++:0}))||t.push(r)}})),t}(t);console.log({peaks:t,groups:n});const l=n.sort(((e,t)=>t.count-e.count)).splice(0,5);console.log(`Guess for track ${Math.round(l[0].tempo)} BPM with ${l[0].count} samples`),console.log(`Other options are ${l.slice(1).map((e=>`${e.tempo} BPM (${e.count})`)).join(", ")}`),a(t.map((({position:t})=>100*t/e.length+"%")))})).catch(console.error)}),[e]),l.createElement("div",{className:s.Z.Beats},l.createElement("div",{className:s.Z.Progress,style:{width:100*t+"%"}}),l.createElement("svg",{width:"100%"},n?.map(((e,t)=>l.createElement("rect",{key:t,x:e,y:"10%",width:"1",height:"80%"}))),l.createElement("rect",{className:s.Z.ProgressBar,x:100*t+"%",y:"0",width:"1",height:"100%"})))}var u=n(35),d=n.n(u),m=n(5394),f=n.n(m);const h=window.AudioContext||window.webkitAudioContext;function p({src:e,progress:t}){const[n,a]=(0,l.useState)(""),[r,i]=(0,l.useState)(null),[c,u]=(0,l.useState)(100),[m,p]=(0,l.useState)(100),[g,v]=(0,l.useState)(2),b=(0,l.useRef)(null),E=(0,l.useRef)(null);return(0,l.useEffect)((()=>{const t=new h,n=E.current=d()(b.current,{audio:{enable:!0},colors:e=>{const t=new(f().scale)([[0,0,255,1],[0,255,255,1],[0,255,0,1],[255,255,0,1],[255,0,0,1]],[0,.15,.3,.5,.75]).domain([0,e]),n=[];for(let l=0;l<e;++l){const e=t(l);n.push(e.hex())}return n}});Object.assign(window,{spectro:n}),fetch(e).then((e=>e.arrayBuffer())).then((e=>(0,o.kS)(t,e))).then((e=>{n.connectSource(e,t),i(e.getChannelData(0))})).catch(console.error)}),[e]),(0,l.useEffect)((()=>{switch(n){case"playing":E.current[E.current._paused?"resume":"start"]();break;case"paused":E.current.pause()}}),[n]),(0,l.useEffect)((()=>{if(r){const e={sampleRate:44100,duration:120,length:5292e3};!async function(e,t,n,l,a){null==l&&(l=n),null==a&&(a={});let r=1/0,o=-1/0;for(let e=0;e<t.length;++e){const n=t[e];n!==-1/0&&(n<r&&(r=n),n>o&&(o=n))}if(r>=o)return;const s=e.getContext("2d");s.clearRect(0,0,e.width,e.height);const i=t.length/n;if(null!=a.pixelsPerFrame){let t=Math.round(a.pixelsPerFrame*i);null!=a.maxPixelWidth&&t>a.maxPixelWidth&&(t=a.maxPixelWidth),e.width=t}const c=e.width/i,u=e.height/l;for(let a=0;a<i;++a){const i=c*a,d=t.subarray(a*n,(a+1)*n);if(d[0]===-1/0)break;for(let t=0;t<l;++t){const n=e.height-(t+1)*u;let l=(d[t]-r)/(o-r);l=Math.pow(l,3),l=Math.round(255*l);const a=`rgb(${l},${255-l},${255-l})`;s.fillStyle=a,s.fillRect(i,n,c,u)}}if(a.markKeyFrame){const l=null==a.keyFrameIndex?await SpeechCommands.getMaxIntensityFrameIndex({data:t,frameSize:n}).data():a.keyFrameIndex;s.strokeStyle="black",s.beginPath(),s.moveTo(c*l,0),s.lineTo(c*l,.1*e.height),s.stroke(),s.beginPath(),s.moveTo(c*l,.9*e.height),s.lineTo(c*l,e.height),s.stroke()}}(b.current,r.slice(0,e.sampleRate*Number(g)/10),Number(c))}}),[r,c,m,g]),l.createElement("div",{className:s.Z.Spectrogram},l.createElement("div",null,l.createElement("input",{type:"range",min:10,max:1e3,value:c,onChange:({target:e})=>u(e.value)})," ",c,l.createElement("input",{type:"range",min:10,max:1e3,value:m,onChange:({target:e})=>p(e.value)})," ",m,l.createElement("input",{type:"range",min:1,max:120,value:g,onChange:({target:e})=>v(e.value)})," ",g),{"":l.createElement("button",{onClick:()=>a("playing")},"Play"),playing:l.createElement("button",{onClick:()=>a("paused")},"Pause"),paused:l.createElement("button",{onClick:()=>a("playing")},"Resume")}[n],l.createElement("div",{className:s.Z.Progress,style:{width:100*t+"%"}}),l.createElement("canvas",{ref:b,id:"canvas"}),l.createElement("div",{id:"word-div"}))}var g=n(9849);const v=new(r());function b({src:e}){const[t,n]=(0,l.useState)(0),a=(0,l.useRef)(),r=(0,l.useRef)();return(0,l.useEffect)((()=>{const e=a.current;function t(){e.paused||(e.duration&&n(e.currentTime/e.duration),r.current=requestAnimationFrame(t))}return e.addEventListener("play",t),e.addEventListener("playing",t),()=>{e.removeEventListener("play",t),e.removeEventListener("playing",t),cancelAnimationFrame(r.current)}}),[]),l.createElement("div",null,l.createElement("video",{ref:a,controls:!0,autoPlay:!1},l.createElement("source",{src:e,type:"audio/mpeg"})),l.createElement(p,{src:e,progress:t}),l.createElement(g.u,{src:e,progress:t}),l.createElement(c,{src:e,progress:t}))}function E(){const[e,t]=(0,l.useState)(null),[n,a]=(0,l.useState)("https://geo-samples.beatport.com/track/b0fa2729-248f-4fd8-8e7d-bd427c30919c.LOFI.mp3"),[r,o]=(0,l.useState)(null),[i,c]=(0,l.useState)(null),u=(0,l.useRef)(),d=(0,l.useRef)();return(0,l.useEffect)((()=>{e&&r&&(v.setAccessToken(e),v.searchTracks(r).then(c,console.error))}),[e,r]),l.createElement("div",{className:s.Z.Search},l.createElement("h2",null,"Search"),l.createElement("div",null,l.createElement("label",null,l.createElement("span",null,"Token"),l.createElement("input",{ref:d,defaultValue:"",onFocus:e=>e.target.select()})),l.createElement("button",{onClick:e=>fetch("https://spotify-web-api-token.herokuapp.com/token").then((e=>e.json())).then((({token:e})=>t(d.current.value=e)))},"Get")),l.createElement("div",null,l.createElement("label",null,l.createElement("span",null,"Query"),l.createElement("input",{ref:u,defaultValue:"artist:BeyoncÃ©"})),l.createElement("button",{onClick:e=>t(d.current.value.trim())||o(u.current.value.trim())},"Find")),n&&l.createElement(b,{key:n,src:n}),l.createElement("ul",null,i?.tracks?.items.map((({album:e,id:t,name:n,preview_url:r,type:o})=>l.createElement("li",{key:t},l.createElement("div",null,"id: ",o," ",t),l.createElement("div",null,"name: ",n),l.createElement("div",null,"preview_url:"," ",l.createElement("a",{href:r,onClick:e=>e.preventDefault()||a(r)},r)),(({artists:e,id:t,images:n,name:a,type:r})=>l.createElement("div",null,l.createElement("div",null,"id: ",r," ",t),l.createElement("div",null,"artists: ",e.map((({name:e})=>e)).join(", ")),l.createElement("div",null,"name: ",a),l.createElement("div",null,n.sort((({width:e},{width:t})=>e-t)).slice(0,1).map((({width:e,height:t,url:n},r)=>l.createElement("img",{key:r,src:n,width:e,height:t,alt:a}))))))(e))))),l.createElement("pre",null,JSON.stringify(i,null,2)))}},7789:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var l=n(9601),a=n.n(l),r=n(2609),o=n.n(r)()(a());o.push([e.id,".CKgSghNKpREBuzbA7Ykt{display:flex;flex-direction:column}.MN3HVNw04LViHBlky330{display:flex;flex-direction:row;margin:2rem;align-items:center}.WkiRKpF351IO1uxS5kA_{width:4em;height:4em;margin:1em;border:2px solid currentColor;border-radius:50%}.veOat6GMQHaV_OvPnyuJ{color:green}.w3mVggYuPlb6ubmpMj69{color:red}.MMKvc1s1Dmbxl193AhLd{flex:1;margin:1em;position:relative}.MMKvc1s1Dmbxl193AhLd canvas{display:block;width:100%;height:8em}.MMKvc1s1Dmbxl193AhLd .hQ3Xho1E4oM84JfXXQSA{position:absolute;z-index:-1;left:0;width:0;top:0;bottom:0;background-color:#d3d3d3}",""]),o.locals={Player:"CKgSghNKpREBuzbA7Ykt",Container:"MN3HVNw04LViHBlky330",Button:"WkiRKpF351IO1uxS5kA_",Button__Play:"veOat6GMQHaV_OvPnyuJ",Button__Stop:"w3mVggYuPlb6ubmpMj69",Waveform:"MMKvc1s1Dmbxl193AhLd",Progress:"hQ3Xho1E4oM84JfXXQSA"};const s=o},204:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var l=n(9601),a=n.n(l),r=n(2609),o=n.n(r)()(a());o.push([e.id,".lfeSvZW11NcsdblvlBkp{display:flex;flex-direction:column}.uR71kJYLVWgDGlNf64Vl{flex:1;margin:1em;position:relative}.uR71kJYLVWgDGlNf64Vl canvas{display:block;height:8em}.uR71kJYLVWgDGlNf64Vl .F0CuPTVNlnd9xRr0meI0{position:absolute;z-index:-1;left:0;width:0;top:0;bottom:0;background-color:#d3d3d3}.vx6pGbp7BjnjJLBxpT0i{flex:1;margin:1em;position:relative}.vx6pGbp7BjnjJLBxpT0i svg{display:block;width:100%;height:8em}.vx6pGbp7BjnjJLBxpT0i svg .oDtmvHDnFFt7VpBU7yls{fill:red}.vx6pGbp7BjnjJLBxpT0i .F0CuPTVNlnd9xRr0meI0{position:absolute;z-index:-1;left:0;width:0;top:0;bottom:0;background-color:#d3d3d3}",""]),o.locals={Search:"lfeSvZW11NcsdblvlBkp",Spectrogram:"uR71kJYLVWgDGlNf64Vl",Progress:"F0CuPTVNlnd9xRr0meI0",Beats:"vx6pGbp7BjnjJLBxpT0i",ProgressBar:"oDtmvHDnFFt7VpBU7yls"};const s=o},3100:(e,t,n)=>{n.d(t,{Z:()=>k});var l=n(6062),a=n.n(l),r=n(4036),o=n.n(r),s=n(6793),i=n.n(s),c=n(7892),u=n.n(c),d=n(1173),m=n.n(d),f=n(2464),h=n.n(f),p=n(7789),g={};g.styleTagTransform=h(),g.setAttributes=u(),g.insert=i().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=m();var v=a()(p.default,g);if(!p.default.locals||e.hot.invalidate){var b=!p.default.locals,E=b?p:p.default.locals;e.hot.accept(7789,(t=>{p=n(7789),function(e,t,n){if(!e&&t||e&&!t)return!1;var l;for(l in e)if((!n||"default"!==l)&&e[l]!==t[l])return!1;for(l in t)if(!(n&&"default"===l||e[l]))return!1;return!0}(E,b?p:p.default.locals,b)?(E=b?p:p.default.locals,v(p.default)):e.hot.invalidate()}))}e.hot.dispose((function(){v()}));const k=p.default&&p.default.locals?p.default.locals:void 0},3738:(e,t,n)=>{n.d(t,{Z:()=>k});var l=n(6062),a=n.n(l),r=n(4036),o=n.n(r),s=n(6793),i=n.n(s),c=n(7892),u=n.n(c),d=n(1173),m=n.n(d),f=n(2464),h=n.n(f),p=n(204),g={};g.styleTagTransform=h(),g.setAttributes=u(),g.insert=i().bind(null,"head"),g.domAPI=o(),g.insertStyleElement=m();var v=a()(p.default,g);if(!p.default.locals||e.hot.invalidate){var b=!p.default.locals,E=b?p:p.default.locals;e.hot.accept(204,(t=>{p=n(204),function(e,t,n){if(!e&&t||e&&!t)return!1;var l;for(l in e)if((!n||"default"!==l)&&e[l]!==t[l])return!1;for(l in t)if(!(n&&"default"===l||e[l]))return!1;return!0}(E,b?p:p.default.locals,b)?(E=b?p:p.default.locals,v(p.default)):e.hot.invalidate()}))}e.hot.dispose((function(){v()}));const k=p.default&&p.default.locals?p.default.locals:void 0}}]);