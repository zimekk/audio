(self.webpackChunk_dev_web=self.webpackChunk_dev_web||[]).push([[815],{1815:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>a});var s=i(2784),n=i(4112),r=i(1724);function a(){const t=(0,s.useRef)(null),e={noteHeight:15,pixelsPerTimeStep:0,instruments:[0],defaultKey:0,scrollType:n.ScrollType.BAR},i={notes:[{start:0,length:1,pitch:69,intensity:127},{start:1,length:1,pitch:71,intensity:127},{start:2,length:1,pitch:72,intensity:127},{start:3,length:1,pitch:74,intensity:127}]};return(0,s.useEffect)((()=>{const s=t.current;s&&new n.StaffSVGRender(i,e,s)}),[t,i]),s.createElement("section",{className:r.Z.Section},s.createElement("h3",null,"Staff"),s.createElement("div",{ref:t}))}},5464:(t,e,i)=>{"use strict";i.r(e),i.d(e,{default:()=>h});var s=i(9601),n=i.n(s),r=i(2609),a=i.n(r)()(n());a.push([t.id,".h9rSsSj3Q0lqGl81I23m{display:block}",""]),a.locals={Section:"h9rSsSj3Q0lqGl81I23m"};const h=a},4112:t=>{self,t.exports=function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}return i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=9)}([function(t,e,i){"use strict";i.r(e),i.d(e,"SVGNS",(function(){return s})),i.d(e,"drawSVGPath",(function(){return n})),i.d(e,"drawSVGText",(function(){return r})),i.d(e,"createSVGGroupChild",(function(){return a})),i.d(e,"setFade",(function(){return h})),i.d(e,"setFill",(function(){return l})),i.d(e,"setStroke",(function(){return o})),i.d(e,"highlightElement",(function(){return c}));const s="http://www.w3.org/2000/svg";function n(t,e,i,n,r,a,h=1){const l=document.createElementNS(s,"path");return l.setAttributeNS(null,"d",e),l.setAttributeNS(null,"transform",`translate(${i}, ${n}) scale(${r}, ${a})`),l.setAttributeNS(null,"opacity",""+h),t.appendChild(l),l}function r(t,e,i,n,r,a=!1,h=1,l=1){const o=document.createElementNS(s,"text");o.setAttributeNS(null,"font-family","Times"),o.setAttributeNS(null,"font-size",r),a&&o.setAttributeNS(null,"font-weight","bold"),o.setAttributeNS(null,"transform",`translate(${i}, ${n}) scale(${h}, ${l})`);const c=document.createTextNode(e);return o.appendChild(c),t.appendChild(o),o}function a(t,e){const i=document.createElementNS(s,"g");return i.setAttribute("data-id",e),t.appendChild(i),i}function h(t,e=!1,i=1,n=0){let r=t.querySelector("animate");if(!r){r=document.createElementNS(s,"animate"),r.setAttributeNS(null,"attributeName","opacity"),r.setAttributeNS(null,"dur","4s"),r.setAttributeNS(null,"fill","freeze"),r.setAttributeNS(null,"keyTimes","0; 0.25; 0.5; 0.75; 1");const t=(i+3*n)/4;r.setAttributeNS(null,"values",`${i}; ${t}; ${n}; ${t}; ${i}`)}return e?r.setAttributeNS(null,"repeatCount","indefinite"):r.setAttributeNS(null,"repeatCount","1"),t.appendChild(r),t}function l(t,e){t.setAttributeNS(null,"fill",e)}function o(t,e,i){t.setAttributeNS(null,"stroke-width",""+e),t.setAttributeNS(null,"stroke",i)}function c(t,e){t.setAttribute("fill",e),t.setAttribute("stroke",e)}},function(t,e,i){"use strict";i.r(e),i.d(e,"MIN_RESOLUTION",(function(){return s})),i.d(e,"MAX_QUARTER_DIVISION",(function(){return n})),i.d(e,"SCALES",(function(){return r})),i.d(e,"KEY_ACCIDENTALS",(function(){return a})),i.d(e,"TREBLE_CLEF",(function(){return h})),i.d(e,"BASS_CLEF",(function(){return l}));const s=.0625,n=240,r=[{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,0,1,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,0,3,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,2,0,0,2,0,2,0,0,3]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-7],accidental:[3,0,3,0,3,0,0,3,0,3,0,0]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[0,1,0,1,0,3,0,0,1,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,0,3,0,3,0,2,0,0,3,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,0,1,0,3,0,3,0,0,1,0]},{steps:[0,-1,-1,-2,-2,-3,-4,-4,-5,-5,-6,-6],accidental:[0,2,0,0,3,0,2,0,2,0,0,3]},{steps:[0,0,-1,-1,-2,-3,-3,-4,-4,-5,-5,-6],accidental:[3,0,3,0,0,3,0,3,0,3,0,0]}],a=[{accidental:1,pitches:[]},{accidental:2,pitches:[70,75,68,73,66]},{accidental:1,pitches:[78,73]},{accidental:2,pitches:[70,75,68]},{accidental:1,pitches:[78,73,80,75]},{accidental:2,pitches:[70]},{accidental:2,pitches:[70,75,68,73,66,71]},{accidental:1,pitches:[78]},{accidental:2,pitches:[70,75,68,73]},{accidental:1,pitches:[78,73,80]},{accidental:2,pitches:[70,75]},{accidental:1,pitches:[78,73,80,75,70]}],h=71,l=50},function(t,e,i){"use strict";i.r(e),i.d(e,"PATH_SCALE",(function(){return s})),i.d(e,"staffLinePath",(function(){return r})),i.d(e,"extraLinePath",(function(){return a})),i.d(e,"barPath",(function(){return h})),i.d(e,"stemPath",(function(){return l})),i.d(e,"singleFlagPath",(function(){return o})),i.d(e,"multiFlagPath",(function(){return c})),i.d(e,"tiePath",(function(){return u})),i.d(e,"dotPath",(function(){return f})),i.d(e,"NOTE_PATHS",(function(){return d})),i.d(e,"REST_PATHS",(function(){return g})),i.d(e,"CLEF_PATHS",(function(){return S})),i.d(e,"ACCIDENTAL_PATHS",(function(){return p}));const s=100,n="M 0,10 C 0,-15 35,-50 80,-50 110,-50 125,-35 125,-10 \n125,15 90,50 45,50 15,50 0,35 0,10 Z",r="m 0,0 h 100",a="m -25,0 h 175",h="m 0,-200 v 400",l="m 0,0 v 100 h 15 v -100 z",o="M0,0 h 12 c 7,100 175,156 62,314 79,-177 -49,\n-193 -61,-200 l -13,-5 z",c="m 0,0 h 10 c 6,72 173,64 84,227 44,-120 -44,\n-123 -94,-167 z",u="M 0,25 C 10,46 30,67 50,67 69,67 90,47 100,25 94,\n65 73,89 50,89 26,89 5,63 0,25 Z",f="M 5 -20 a 20 20 0 1 0 0.00001 0 z",d={4:{path:"m 0,0 c 0,-37 49,-51 79,-51 31,0 83,13 83,51 0,39 \n-55,51 -84,51 C 49,51 0,37 0,0 Z m 111,31 c 13,-19 0,-58 -22,-68 -33,-15 \n-53,10 -39,49 9,27 48,39 61,19 z",width:150,stemVSteps:0,stemAnchor:0,flags:0},2:{path:"m 0,10 c 0,-25 35,-60 80,-60 15,0 45,4 45,40 C 125,16 \n89,50 45,50 17,50 0,36 0,10 Z m 71,7 c 17,-11 45,-34 38,-45 -7,-10 -39,1 \n-57,12 -19,11 -42,31 -36,42 6,10 37,2 55,-9 z",width:125,stemVSteps:7,stemAnchor:-10,flags:0},1:{path:n,width:125,stemVSteps:7,stemAnchor:-10,flags:0},.5:{path:n,width:125,stemVSteps:7,stemAnchor:-10,flags:1},.25:{path:n,width:125,stemVSteps:9,stemAnchor:-10,flags:2},.125:{path:n,width:125,stemVSteps:11,stemAnchor:-10,flags:3},.0625:{path:n,width:125,stemVSteps:13,stemAnchor:-10,flags:4}},g={4:"m 0,-50 h 125 v -50 H 0 Z",2:"M 0,0 H 125 V -50 H 0 Z",1:"m 0,-25 c 39,-39 37,-75 8,-120 l 6,-5 61,103 C \n40,-13 31,4 73,71 l -5,5 C 14,52 16,125 67,144 l -4,6 C -37,102 -1,22 59,60 Z",.5:"m 52,-47 c 26,-2 42,-21 48,-42 l 12,4 L 64,83 52,79 \n88,-49 c 0,0 -17,22 -57,22 -16,0 -31,-13 -31,-27 0,-18 10,-31 27,-31 17,0 \n33,15 25,38 z",.25:"m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 \nc -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 \n31,27 40,0 57,-22 57,-22 l -36,128 12,4 77,-270 z",.125:"m 129,-191 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -20,69 \nc -7,18 -22,33 -45,35 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 15,27 \n31,27 40,0 57,-22 57,-22 L 68,20 C 61,37 46,51 24,52 32,29 16,14 -1,14 c \n-17,0 -27,13 -27,31 0,14 15,27 31,27 38,0 55,-20 57,-22 l -36,128 12,4 \n105,-369 z",.0625:"m 158,-292 c -6,21 -22,40 -48,42 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 l -17,61 \nv 0 c -6,21 -22,40 -48,42 8,-23 -8,-38 -25,-38 -17,0 -27,13 -27,31 0,14 \n15,27 31,27 40,0 57,-22 57,-22 l -20,69 c -7,18 -22,33 -45,35 8,-23 -8,-38 \n-25,-38 -17,0 -27,13 -27,31 0,14 15,27 31,27 40,0 57,-22 57,-22 L 68,20 C \n61,37 46,51 24,52 32,29 16,14 -1,14 c -17,0 -27,13 -27,31 0,14 15,27 31,27 \n38,0 55,-20 57,-22 l -36,128 12,4 134,-469 z"},S={50:"m 101,-199 c -49,0 -100,28 -100,83 0,39 58,57 82,26 15,-20 \n-4,-47 -32,-47 -23,1 -25,0 -25,-8 0,-22 40,-46 71,-41 91,16 67,208 -105,302 \n75,-27 198,-94 211,-201 6,-66 -42,-114 -102,-114 z m 143,33 c -13,0 -23,11 \n-23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 z m 2,83 c \n-13,0 -23,11 -23,24 0,14 10,24 23,24 13,0 23,-11 23,-24 0,-13 -10,-24 -23,-24 \nz",71:"M 139,48 C 102,57 76,120 131,151 41,128 64,24 129,2 L \n117,-57 C -32,47 26,217 166,182 Z m 12,-1 27,131 C 242,153 216,46 151,47 \nZ m -35,-177 c 34,-23 82,-117 50,-140 -23,-17 -71,33 -50,140 z m -10,10 c \n-23,-77 -20,-200 48,-213 19,-4 89,171 -26,266 l 13,66 c 120,-6 137,155 \n39,191 l 12,58 c 30,131 -137,145 -138,47 0,-29 37,-59 63,-37 21,18 25,71 \n-25,70 32,42 103,0 91,-65 L 167,193 C 56,232 -112,63 106,-120 Z"},p=[null,"m -49,-121 v 52 l -29,9 v -48 h -8 v 51 l -20,6 v 29 l \n20,-6 v 70 l -20,6 v 30 l 20,-6 v 51 h 8 V 69 l 30,-8 v 50 h 8 V 58 l 20,-6 \nV 23 l -20,6 v -71 l 20,-6 v -29 l -20,6 v -50 z m 1,82 v 71 l -29,9 v -71 z","M -106,-166 V 67 c 52,-42 85,-56 85,-94 0,-47 -46,-51 \n-73,-22 v -117 z m 31,120 c 20,0 42,46 -20,91 V -7 c 0,-28 10,-39 20,-39 z","m -81,-58 v -48 H -92 V 73 l 60,-13 v 50 h 11 V -72 Z m \n50,24 v 58 l -50,11 v -58 z"]},function(t,e,i){"use strict";i.r(e),i.d(e,"DEFAULT_TEMPO",(function(){return s})),i.d(e,"DEFAULT_KEY_SIGNATURE",(function(){return n})),i.d(e,"DEFAULT_TIME_SIGNATURE",(function(){return r})),i.d(e,"getBarLength",(function(){return a}));const s={start:0,qpm:60},n={start:0,key:0},r={start:0,numerator:4,denominator:4};function a(t){return 4*t.numerator/t.denominator}},function(t,e,i){"use strict";i.r(e),i.d(e,"splitStaffNote",(function(){return n})),i.d(e,"StaffBlock",(function(){return r}));var s=i(1);function n(t,e){const i=t.start+t.length-e;let s=null;return e>t.start&&i>0&&(t.length-=i,s={start:e,length:i,pitch:t.pitch,intensity:t.intensity,vSteps:t.vSteps,accidental:t.accidental,tiedFrom:t},t.tiedTo&&(s.tiedTo=t.tiedTo,t.tiedTo.tiedFrom=s),t.tiedTo=s),s}class r{constructor(t=0,e=0,i=[],s=0,n=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER){this.start=t,this.length=e,this.headIndex=0,this.notes=i,this.barNumber=s,this.maxVStep=n,this.minVStep=r}addNote(t){let e=!1,i=this.notes.length,s=-1;0===this.notes.length&&(this.start=t.start);for(let n=0;-1===s&&n<this.notes.length;++n)i===this.notes.length&&t.length<this.notes[n].length&&(i=n),t.pitch===this.notes[n].pitch&&(t.length<this.notes[n].length?s=n:e=!0);return e||(this.notes.splice(i,0,t),this.minVStep=Math.max(t.vSteps,this.minVStep),this.maxVStep=Math.min(t.vSteps,this.maxVStep),s>=0&&(s+=s>=i?1:0,this.notes[s].tiedFrom&&(t.tiedFrom=this.notes[s].tiedFrom,t.tiedFrom.tiedTo=this.notes[i]),this.notes.splice(s,1))),this.length=this.notes[this.notes.length-1].length,!e}split(t,e){const i=this.start+this.length-t;let s=null;return t>this.start&&i>0&&(s=new r(t,i,[],e.barNumberAtQ(t)),this.length-=i,this.notes.forEach((e=>{const i=n(e,t);i&&s.addNote(i)}))),s&&this.beatEnd&&(s.beatEnd=!0,this.beatEnd=!1),s}splitToBeat(t){const e=t.timeSignatureAtQ(this.start),i=t.barLenghtAtQ(this.start),s=this.barNumber-Math.floor(this.barNumber),n=Math.round(i*s*1e6)/1e6,r=this.start-n,h=4/e.denominator,l=n/h,o=Math.ceil(l);let c=null;if(a(o-l)){this.beatBegin=!0;const i=Math.round(1e6*(r+e.numerator*h))/1e6;c=this.split(i,t),a(this.start+this.length-i)&&(this.beatEnd=!0)}else{const e=Math.round(1e6*(r+o*h))/1e6;c=this.split(e,t),a(this.start+this.length-e)&&(this.beatEnd=!0)}return c&&(this.beatEnd=!0),c}splitToSymbols(t,e){let i=null;if(this.length>=s.MIN_RESOLUTION)this.notes.length||this.length!==t.barLenghtAtQ(this.start)?i=e?this.splitShorter(t):this.splitLonger(t):this.headIndex=4;else{const t=a(this.length)?"[infinite]":""+4/this.length;console.warn("%cStaffRender:","background:orange; color:white",`StaffRender does not handle notes shorther than 1/${4/s.MIN_RESOLUTION}th, and this score tries to draw a 1/${t}th. Shortest possible note will be drawn instead.`),this.headIndex=s.MIN_RESOLUTION,i=null}return i}splitShorter(t){let e=this.length,i=0,s=0,n=0;for(let r=4;!a(e);r/=2)a(e-3*r/2)&&(t.allowDottedRests||this.notes.length)?(e-=3*r/2,i=3*r/2,s=r,n=1):e>=r?(e-=r,i=r,s=r):a(e-4*r/5)?(e-=4*r/5,i=4*r/5,s=r,n=5):a(e-2*r/3)&&(e-=2*r/3,i=2*r/3,s=r,n=3);const r=this.split(this.start+i,t);return this.headIndex=s,this.headAlteration=n,r}splitLonger(t){let e=null;for(let i=4;!this.headIndex;i/=2)a(this.length-3*i/2)&&(t.allowDottedRests||this.notes.length)?(e=this.split(this.start+3*i/2,t),this.headIndex=i,this.headAlteration=1):this.length>=i?(e=this.split(this.start+i,t),this.headIndex=i):a(this.length-4*i/5)?(e=this.split(this.start+4*i/5,t),this.headIndex=i,this.headAlteration=5):a(this.length-2*i/3)&&(e=this.split(this.start+2*i/3,t),this.headIndex=i,this.headAlteration=3);return e}mergeToMap(t){const e=t.get(this.start);void 0!==e?this.notes.forEach((t=>e.addNote(t))):t.set(this.start,this)}isBarBeginning(){return this.barNumber-Math.trunc(this.barNumber)==0}setBeaming(t,e){}}function a(t){return 0===Math.round(1e6*t)}},function(t,e,i){"use strict";i.r(e),i.d(e,"STEM_WIDTH",(function(){return s})),i.d(e,"LINE_STROKE",(function(){return n})),i.d(e,"COMPACT_SPACING",(function(){return r}));const s=15,n=1,r=150},function(t,e,i){"use strict";i.r(e),i.d(e,"StaffModel",(function(){return h})),i.d(e,"getNoteDetails",(function(){return l}));var s=i(3),n=i(7),r=i(4),a=i(1);i.d(e,"KEY_ACCIDENTALS",(function(){return a.KEY_ACCIDENTALS}));class h{constructor(t,e){this.staffInfo=null,this.clef=function(t){let e=0,i=0;return t.notes.forEach((t=>{e+=t.pitch,++i})),e/i<60?a.BASS_CLEF:a.TREBLE_CLEF}(t),this.staffBlockMap=null,this.update(t,e)}update(t,e){t.notes.sort(((t,e)=>t.start-e.start)),this.lastQ=0,t.notes.forEach((t=>{t.start+t.length>this.lastQ&&(this.lastQ=t.start+t.length)})),t.tempos&&t.tempos.length?t.tempos.sort(((t,e)=>t.start-e.start)):t.tempos=[s.DEFAULT_TEMPO],0!==t.tempos[0].start&&(t.tempos=[s.DEFAULT_TEMPO].concat(t.tempos));const i=e?{start:0,key:e}:s.DEFAULT_KEY_SIGNATURE;t.keySignatures&&t.keySignatures.length?t.keySignatures.sort(((t,e)=>t.start-e.start)):t.keySignatures=[i],0!==t.keySignatures[0].start&&(t.keySignatures=[i].concat(t.keySignatures)),t.timeSignatures&&t.timeSignatures.length?t.timeSignatures.sort(((t,e)=>t.start-e.start)):t.timeSignatures=[s.DEFAULT_TIME_SIGNATURE],0!==t.timeSignatures[0].start&&(t.timeSignatures=[s.DEFAULT_TIME_SIGNATURE].concat(t.timeSignatures)),this.barsInfo=new n.BarsInfo(t,this.lastQ),this.infoToBlocks(t)}infoToBlocks(t){if(null===this.staffBlockMap||t.notes.length!==this.staffInfo.notes.length||t.tempos.length!==this.staffInfo.tempos.length||t.keySignatures.length!==this.staffInfo.keySignatures.length||t.timeSignatures.length!==this.staffInfo.timeSignatures.length){this.staffInfo=t;const e=new Map;let i={},s=0,n=null;for(this.staffInfo.notes.forEach((t=>{const a=function(t){return{start:t.start,length:t.length,pitch:t.pitch,intensity:t.intensity,vSteps:0,accidental:0}}(t),h=this.barsInfo.barNumberAtQ(a.start),o=Math.trunc(h);o>s&&(s=o,i={});const c=this.barsInfo.keySignatureAtQ(a.start);if(function(t,e,i,s){const n=l(t.pitch,i,s);n.vSteps in e?n.accidental===e[n.vSteps]?n.accidental=0:(3===e[n.vSteps]?n.accidental=n.keyAccidental:0===n.accidental&&(n.accidental=3),e[n.vSteps]=n.accidental):(t.tiedFrom&&(n.accidental=0),e[n.vSteps]=n.accidental),t.vSteps=n.vSteps,t.accidental=n.accidental}(a,i,this.clef,c),n||(0!==a.start&&(n=new r.StaffBlock(0,a.start,[],h),n.mergeToMap(e)),n=new r.StaffBlock),0===n.notes.length||n.start===a.start)n.addNote(a);else{const t=n.start+n.length;for(;n.notes.length&&n.notes[0].start<a.start;){const t=Math.min(a.start,n.start+n.notes[0].length);let i=n.split(t,this.barsInfo);n.mergeToMap(e),i||(i=new r.StaffBlock),n=i}n.length?n.addNote(a):(t!==a.start&&new r.StaffBlock(t,a.start-t,[],this.barsInfo.barNumberAtQ(t)).mergeToMap(e),n=new r.StaffBlock(a.start,a.length,[a],h,a.vSteps,a.vSteps))}}));n.notes.length&&n.notes[0].start<Number.MAX_VALUE;){const t=n.start+n.notes[0].length;let i=n.split(t,this.barsInfo);n.mergeToMap(e),i||(i=new r.StaffBlock),n=i}this.lastQ=n.start+n.length,this.staffBlockMap=new Map;let a=null;e.forEach((t=>{let e=null;do{e=t.splitToBeat(this.barsInfo);const i=!t.beatBegin&&t.beatEnd;let s=null;do{s=t.splitToSymbols(this.barsInfo,i),t.setBeaming(a,this.barsInfo),t.mergeToMap(this.staffBlockMap),s&&(a=t,t=s)}while(s);e&&(a=t,t=e)}while(e)}))}return this.staffBlockMap}}function l(t,e,i){const s=t-60,n=Math.floor(s/12),r=s-12*n,h=a.SCALES[i].steps[r],l=71===e?6:-6,o=1===a.KEY_ACCIDENTALS[i].accidental?69+(r+3)%12:64+(r+8)%12;return{vSteps:l-7*n+h,accidental:a.SCALES[i].accidental[r],keyAccidental:a.KEY_ACCIDENTALS[i].pitches.indexOf(o)>-1?a.KEY_ACCIDENTALS[i].accidental:0}}},function(t,e,i){"use strict";i.r(e),i.d(e,"BarsInfo",(function(){return r}));var s=i(3),n=i(1);class r{constructor(t,e){this.barsInfo=[];let i=0,n=0,r=0,a=t.tempos[0],h=t.keySignatures[0],l=t.timeSignatures[0],o=0,c=Object(s.getBarLength)(l);for(let u=0;u<e;u+=1/16){const e={start:u,barNumber:o+(u-l.start)/c,barLength:c,tempo:a,keySignature:h,timeSignature:l};i<t.tempos.length&&t.tempos[i].start===u&&(a=t.tempos[i++],e.tempo=a,e.tempoChange=!0),n<t.keySignatures.length&&t.keySignatures[n].start===u&&(h=t.keySignatures[n++],e.keySignature=h,e.keyChange=!0),r<t.timeSignatures.length&&t.timeSignatures[r].start===u&&(o=e.barNumber,l=t.timeSignatures[r++],e.timeSignature=l,c=Object(s.getBarLength)(l),e.barLength=c,e.timeChange=!0),this.barsInfo.push(e)}}barNumberAtQ(t){const e=this.barsInfo[Math.trunc(16*t)],i=(t-e.start)/e.barLength;return e.barNumber+i}barLenghtAtQ(t){return this.barsInfo[Math.trunc(16*t)].barLength}tempoAtQ(t,e=!1){const i=this.barsInfo[0];return!e||i.tempoChange?i.tempo.qpm:-1}keySignatureAtQ(t,e=!1){const i=this.barsInfo[Math.trunc(16*t)];return!e||i.keyChange?i.keySignature.key:-1}timeSignatureAtQ(t,e=!1){const i=this.barsInfo[Math.trunc(16*t)];return!e||i.timeChange?i.timeSignature:null}quartersToTime(t){return t/this.barsInfo[0].tempo.qpm*60}timeToQuarters(t){const e=t*this.barsInfo[0].tempo.qpm/60;return Math.round(e*n.MAX_QUARTER_DIVISION)/n.MAX_QUARTER_DIVISION}}},function(t,e,i){"use strict";i.r(e),i.d(e,"MAX_QUARTER_DIVISION",(function(){return l})),i.d(e,"ScrollType",(function(){return o})),i.d(e,"StaffSVGRender",(function(){return c}));var s=i(5),n=i(0),r=i(2),a=i(3),h=i(6);const l=16;var o;!function(t){t[t.PAGE=0]="PAGE",t[t.NOTE=1]="NOTE",t[t.BAR=2]="BAR"}(o||(o={}));class c{constructor(t,e,i){this.handleScrollEvent=t=>{this.lastKnownScrollLeft=this.parentElement.scrollLeft,this.ticking||window.requestAnimationFrame((()=>{this.changeAndDrawSignaturesIfNeeded(this.lastKnownScrollLeft),this.ticking=!1})),this.ticking=!0},this.staffInfo=t,this.config={noteHeight:e.noteHeight||6,noteSpacing:e.noteSpacing||1,pixelsPerTimeStep:e.pixelsPerTimeStep||30,noteRGB:e.noteRGB||"8, 41, 64",activeNoteRGB:e.activeNoteRGB||"240, 84, 119"},this.div=i,this.scrollType=e.scrollType||o.PAGE,this.scale=this.config.noteHeight/r.PATH_SCALE,(void 0===e.pixelsPerTimeStep||e.pixelsPerTimeStep<=0)&&(this.config.pixelsPerTimeStep=0,this.config.noteSpacing=s.COMPACT_SPACING*this.scale),this.staffModel=new h.StaffModel(this.staffInfo,e.defaultKey),this.currentKey=this.staffModel.barsInfo.keySignatureAtQ(0),this.currentTimeSignature=this.staffModel.barsInfo.timeSignatureAtQ(0),this.clear(),this.redraw()}clear(){for(;this.div.lastChild;)this.div.removeChild(this.div.lastChild);this.div.style.overflow="visible",this.div.style.position="relative",this.overlaySVG=document.createElementNS(n.SVGNS,"svg"),this.overlaySVG.style.position="absolute",this.div.appendChild(this.overlaySVG),this.overlayG=Object(n.createSVGGroupChild)(this.overlaySVG,"overlay"),this.signaturesBlinking=!1,this.signaturesQuarters=0,this.parentElement=document.createElement("div"),this.parentElement.style.overflow="auto",this.div.appendChild(this.parentElement),this.ticking=!1,this.lastKnownScrollLeft=0,this.parentElement.addEventListener("scroll",this.handleScrollEvent),this.staffSVG=document.createElementNS(n.SVGNS,"svg"),this.parentElement.appendChild(this.staffSVG),this.staffG=Object(n.createSVGGroupChild)(this.staffSVG,"staff"),this.linesG=Object(n.createSVGGroupChild)(this.staffSVG,"lines"),Object(n.setStroke)(this.linesG,s.LINE_STROKE,this.getColor()),this.staffG.appendChild(this.linesG),this.musicG=Object(n.createSVGGroupChild)(this.staffSVG,"music"),Object(n.setFill)(this.musicG,this.getColor()),Object(n.setStroke)(this.musicG,0,this.getColor()),this.staffG.appendChild(this.musicG),this.signaturesG=Object(n.createSVGGroupChild)(this.staffSVG,"signatures"),this.staffG.appendChild(this.signaturesG),this.signaturesList=[{x:0,q:0}],this.signatureCurrent=0,this.signatureNext=0,this.changeKeySignatureIfNeeded(0),this.changeTimeSignatureIfNeeded(0),this.vStepSize=this.config.noteHeight/2,this.hStepSize=this.config.pixelsPerTimeStep,this.staffOffset=0,this.height=0,this.width=0,this.playingNotes=[],this.lastBar=0,this.lastQ=-1}redraw(t,e){let i=-1;const s=0===this.config.pixelsPerTimeStep;if(t){const r=[];this.playingNotes.forEach((e=>{this.isPaintingActiveNote(e,t)?r.push(e):Object(n.highlightElement)(this.getGroup(e),this.getColor(!1))})),this.playingNotes=r;const a=this.getGroup(t);if(a){this.playingNotes.push(t),Object(n.highlightElement)(a,this.getColor(!0)),i=a.getBoundingClientRect().left-this.staffSVG.getBoundingClientRect().left;const r=t.start,h=a.getAttribute("data-is-bar-beginning");(this.scrollType!==o.BAR||h)&&this.scrollIntoViewIfNeeded(e,i),!s&&this.signaturesBlinking&&r>=this.signaturesQuarters&&(this.signaturesBlinking=!1,Object(n.setFade)(this.overlayG,this.signaturesBlinking))}}else{const t=-1===this.lastQ;this.staffModel.update(this.staffInfo,this.config.defaultKey);let e=0,i=0;t?(i=this.drawSignatures(this.overlayG,e,!0,!0,!0),s&&(this.width=0,i+=this.config.noteSpacing)):e=this.width;const n=new Map;this.staffModel.staffBlockMap.forEach(((t,r)=>{s||(e=this.staffModel.barsInfo.quartersToTime(r)*this.hStepSize),r>this.lastQ&&(i+=this.drawStaffBlock(t,e+i,n),this.lastQ=r)}));const r=this.staffSVG.getBoundingClientRect(),a=this.musicG.getBoundingClientRect();if(this.updateVerticalBoundaries(a.top-r.top,a.bottom-r.top),s)this.width+=i;else{const t=this.staffModel.staffBlockMap.get(this.lastQ),e=this.staffModel.barsInfo.quartersToTime(this.lastQ+t.length);this.width=e*this.config.pixelsPerTimeStep}this.staffSVG.setAttributeNS(null,"width",""+this.width),this.redrawStaffLines(this.linesG,0,this.width)}return i}isPaintingActiveNote(t,e){const i=t.start===e.start,s=t.start<=e.start&&t.start+t.length>=e.start+e.length;return i||s}drawStaffBlock(t,e,i){const s=t.start;let n=this.drawBarIfNeeded(s,e);return n+=this.drawSignaturesIfNeeded(s,e+n),t.notes.length?n+=this.drawNotes(t,e+n,i):n+=this.drawRests(t,e+n),n}drawNotes(t,e,i){let a=0;const h=r.NOTE_PATHS[t.headIndex];let l;if(h.stemAnchor&&(l=Object(n.createSVGGroupChild)(this.musicG,"stem")),t.notes.forEach((s=>{const l=this.getOpacity(s.intensity),o=s.vSteps*this.vStepSize,c=2*(s.vSteps>0?Math.floor(s.vSteps/2):Math.ceil(s.vSteps/2)),u=s.vSteps>0?-2:2;for(let t=c;Math.abs(t)>4;t+=u)Object(n.drawSVGPath)(this.linesG,r.extraLinePath,e+a,t*this.vStepSize,this.scale,1);let f=null;s.tiedFrom&&(f=i.get(s.tiedFrom),f||console.warn("%cStaffRender:","background:orange; color:white","Wrong linkage at q = "+s.start));const d=f?f.g:Object(n.createSVGGroupChild)(this.musicG,`${s.start}-${s.pitch}`);if(t.isBarBeginning()&&d.setAttribute("data-is-bar-beginning","true"),s.tiedFrom&&f){const t=e+a-i.get(s.tiedFrom).xHeadRight;Object(n.drawSVGPath)(d,r.tiePath,i.get(s.tiedFrom).xHeadRight,o,t/r.PATH_SCALE,this.scale*(s.vSteps<0?-1:1),l)}Object(n.drawSVGPath)(d,h.path,e+a,o,this.scale,this.scale,l);const g=e+a+h.width*this.scale;1===t.headAlteration&&Object(n.drawSVGPath)(d,r.dotPath,e+a+h.width*this.scale+this.vStepSize/2,o-this.vStepSize/2,this.scale,this.scale,l),0!==s.accidental&&Object(n.drawSVGPath)(d,r.ACCIDENTAL_PATHS[s.accidental],e+a,o,this.scale,this.scale,l),s.tiedTo&&i.set(s,{g:d,xHeadRight:g})})),h.stemAnchor){let i,o,c=e+a;const u=h.stemAnchor*this.scale,f=t.minVStep+t.maxVStep<0,d=h.flags>2?2*(h.flags-2):0;if(f?(i=t.maxVStep*this.vStepSize-u,o=(t.minVStep+7+d)*this.vStepSize):(c+=(h.width-s.STEM_WIDTH)*this.scale,i=t.minVStep*this.vStepSize+u,o=(t.maxVStep-7-d)*this.vStepSize),Object(n.drawSVGPath)(l,r.stemPath,c,i,this.scale,(o-i)/r.PATH_SCALE),1===h.flags)Object(n.drawSVGPath)(l,r.singleFlagPath,c,o,this.scale,this.scale*(f?-1:1),1);else if(h.flags>1)for(let t=0;t<h.flags;++t)Object(n.drawSVGPath)(l,r.multiFlagPath,c,o,this.scale,this.scale*(f?-1:1),1),o+=(f?-2:2)*this.vStepSize}return 0===this.config.pixelsPerTimeStep&&(a+=h.width*this.scale,l&&(a+=l.getBoundingClientRect().width),a+=this.config.noteSpacing),a}drawRests(t,e){let i=0;const s=Object(n.drawSVGPath)(this.musicG,r.REST_PATHS[t.headIndex],e+i,0,this.scale,this.scale);return this.config.pixelsPerTimeStep>0?e+=this.staffModel.barsInfo.quartersToTime(t.headIndex)*this.hStepSize:(i+=s.getBoundingClientRect().width,i+=this.config.noteSpacing),i}redrawStaffLines(t,e,i){let s=t.querySelector('g[data-id="staff-five-lines"]');if(s)s.setAttributeNS(null,"transform",`scale(${i/r.PATH_SCALE}, 1)`);else{s=Object(n.createSVGGroupChild)(t,"staff-five-lines");const a=0;for(let t=-4;t<=4;t+=2)Object(n.drawSVGPath)(s,r.staffLinePath,e,a+t*this.vStepSize,i/r.PATH_SCALE,1)}return s}drawBarIfNeeded(t,e){let i=0;if(0!==t){const s=this.lastBar+Object(a.getBarLength)(this.currentTimeSignature);t>=s&&(this.config.pixelsPerTimeStep>0?e-=this.config.noteSpacing:i=this.config.noteSpacing,Object(n.drawSVGPath)(this.linesG,r.barPath,e,0,1,this.scale),this.lastBar=s)}return i}clearSignatureOverlay(){for(;this.overlayG.lastChild;)this.overlayG.removeChild(this.overlayG.lastChild)}drawSignaturesIfNeeded(t,e){let i=0;if(0!==t){const r=this.changeKeySignatureIfNeeded(t),a=this.changeTimeSignatureIfNeeded(t);if(r||a){const h=s.COMPACT_SPACING*this.scale*(this.config.pixelsPerTimeStep>0?3:2);this.signaturesList.push({x:e-h,q:t}),null===this.signatureNext&&(this.signatureNext=e);const l=t>0?Object(n.createSVGGroupChild)(this.signaturesG,"signatures"):this.overlayG;i+=this.drawSignatures(l,e+i,!1,r,a)}}return 0===this.config.pixelsPerTimeStep?i:0}drawSignatures(t,e,i,a,l){const o=s.COMPACT_SPACING*this.scale;let c,u=o;const f=t===this.overlayG||this.config.pixelsPerTimeStep>0;if(f){c=document.createElementNS(n.SVGNS,"rect"),c.setAttributeNS(null,"x",""+e),c.setAttributeNS(null,"y","0"),c.setAttributeNS(null,"width","1"),c.setAttributeNS(null,"height","1"),c.setAttribute("data-id","background"),t.appendChild(c);const i=document.defaultView.getComputedStyle(this.div.parentElement);c.setAttributeNS(null,"fill",i.getPropertyValue("background-color"))}if(i){const i=Object(n.drawSVGPath)(t,r.CLEF_PATHS[this.staffModel.clef],e+u,0,this.scale,this.scale);Object(n.setFill)(i,this.getColor()),u+=3*o}if(a){const i=h.KEY_ACCIDENTALS[this.currentKey].accidental,s=71===this.staffModel.clef?0:14;h.KEY_ACCIDENTALS[this.currentKey].pitches.forEach((a=>{const l=Object(h.getNoteDetails)(a,this.staffModel.clef,this.currentKey).vSteps,o=Object(n.drawSVGPath)(t,r.ACCIDENTAL_PATHS[i],e+u,(s+l)*this.vStepSize,this.scale,this.scale);Object(n.setFill)(o,this.getColor()),u+=o.getBoundingClientRect().width}))}if(l){const i=Object(n.createSVGGroupChild)(t,"time-key"),s=2.85*this.config.noteHeight+"px";Object(n.drawSVGText)(i,""+this.currentTimeSignature.numerator,e+u,-.5,s,!0),Object(n.drawSVGText)(i,""+this.currentTimeSignature.denominator,e+u,4*this.vStepSize-.5,s,!0),Object(n.setFill)(i,this.getColor()),u+=i.getBoundingClientRect().width+o}const d=this.redrawStaffLines(t,e,u);Object(n.setStroke)(d,s.LINE_STROKE,this.getColor());const g=this.div.getBoundingClientRect(),S=t.getBoundingClientRect();if(this.updateVerticalBoundaries(S.top-g.top,S.bottom-g.top),f&&(c.setAttributeNS(null,"y",""+-this.staffOffset),c.setAttributeNS(null,"height",""+this.height),c.setAttributeNS(null,"width",""+u)),t===this.overlayG){this.overlaySVG.setAttributeNS(null,"width",""+(u+5));for(let e=0;e<5;++e){const i=Object(n.drawSVGPath)(t,r.stemPath,u+e,e*e-this.staffOffset,1/s.STEM_WIDTH,(this.height-2*e*e)/r.PATH_SCALE,(e-5)*(e-5)*2/r.PATH_SCALE);Object(n.setFill)(i,this.getColor())}}if(this.config.pixelsPerTimeStep>0){const i=0===this.signaturesQuarters;return i&&(this.signaturesQuarters=this.staffModel.barsInfo.timeToQuarters(u/this.hStepSize)),(i||e>0)&&(this.signaturesBlinking=!0,Object(n.setFade)(t,this.signaturesBlinking)),0}return u}changeKeySignatureIfNeeded(t){const e=this.staffModel.barsInfo.keySignatureAtQ(t,!0);return e>=0&&(this.currentKey=e,!0)}changeTimeSignatureIfNeeded(t){const e=this.staffModel.barsInfo.timeSignatureAtQ(t,!0);return!!e&&(this.currentTimeSignature=e,!0)}changeAndDrawSignaturesIfNeeded(t){let e;if(t<this.signatureCurrent||null!==this.signatureNext&&this.signatureNext<=t){e=this.signaturesList[0].q,this.signatureNext=null;for(let i=0;i<this.signaturesList.length;++i){if(t<this.signaturesList[i].x){this.signatureNext=this.signaturesList[i].x;break}this.signatureCurrent=this.signaturesList[i].x,e=this.signaturesList[i].q}}if(void 0!==e){const t=this.currentKey,i=this.currentTimeSignature;this.changeKeySignatureIfNeeded(e),this.changeTimeSignatureIfNeeded(e),this.clearSignatureOverlay(),this.drawSignatures(this.overlayG,0,!0,!0,!0),this.currentKey=t,this.currentTimeSignature=i}this.config.pixelsPerTimeStep>0&&0===t&&(this.signatureNext=0,this.signaturesBlinking=!0,Object(n.setFade)(this.overlayG,this.signaturesBlinking))}scrollIntoViewIfNeeded(t,e){if(t)if(this.scrollType===o.PAGE){const t=this.parentElement.getBoundingClientRect().width;e>this.parentElement.scrollLeft+t&&(this.parentElement.scrollLeft=e-20)}else{const t=this.parentElement.getBoundingClientRect().width;this.parentElement.scrollLeft=e-.5*t}}updateVerticalBoundaries(t,e){let i=0;if(t<0){this.staffOffset-=t;const e=`translate(0, ${this.staffOffset})`;this.overlayG.setAttributeNS(null,"transform",e),this.staffG.setAttributeNS(null,"transform",e),i=this.height-t}if(i=Math.max(i,e-t),i>this.height){this.height=i,this.overlaySVG.setAttributeNS(null,"height",""+this.height),this.staffSVG.setAttributeNS(null,"height",""+this.height);const t=this.div.querySelectorAll('rect[data-id="background"]');for(let e=0;e<t.length;++e){const i=t[e];i.setAttributeNS(null,"y",""+-this.staffOffset),i.setAttributeNS(null,"height",""+this.height)}}}getColor(t=!1){return`rgb(${t?this.config.activeNoteRGB:this.config.noteRGB})`}getOpacity(t){return t?t/127*.8+.2:1}getGroup(t){const e=t.start,i=t.pitch;return this.staffSVG.querySelector(`g[data-id="${e}-${i}"]`)}}},function(t,e,i){"use strict";i.r(e);var s=i(8);i.d(e,"MAX_QUARTER_DIVISION",(function(){return s.MAX_QUARTER_DIVISION})),i.d(e,"ScrollType",(function(){return s.ScrollType})),i.d(e,"StaffSVGRender",(function(){return s.StaffSVGRender}));var n=i(6);i.d(e,"KEY_ACCIDENTALS",(function(){return n.KEY_ACCIDENTALS})),i.d(e,"StaffModel",(function(){return n.StaffModel})),i.d(e,"getNoteDetails",(function(){return n.getNoteDetails}));var r=i(4);i.d(e,"splitStaffNote",(function(){return r.splitStaffNote})),i.d(e,"StaffBlock",(function(){return r.StaffBlock}));var a=i(3);i.d(e,"DEFAULT_TEMPO",(function(){return a.DEFAULT_TEMPO})),i.d(e,"DEFAULT_KEY_SIGNATURE",(function(){return a.DEFAULT_KEY_SIGNATURE})),i.d(e,"DEFAULT_TIME_SIGNATURE",(function(){return a.DEFAULT_TIME_SIGNATURE})),i.d(e,"getBarLength",(function(){return a.getBarLength}))}])},1724:(t,e,i)=>{"use strict";i.d(e,{Z:()=>T});var s=i(6062),n=i.n(s),r=i(4036),a=i.n(r),h=i(6793),l=i.n(h),o=i(7892),c=i.n(o),u=i(1173),f=i.n(u),d=i(2464),g=i.n(d),S=i(5464),p={};p.styleTagTransform=g(),p.setAttributes=c(),p.insert=l().bind(null,"head"),p.domAPI=a(),p.insertStyleElement=f();var m=n()(S.default,p);if(!S.default.locals||t.hot.invalidate){var b=!S.default.locals,A=b?S:S.default.locals;t.hot.accept(5464,(e=>{S=i(5464),function(t,e,i){if(!t&&e||t&&!e)return!1;var s;for(s in t)if((!i||"default"!==s)&&t[s]!==e[s])return!1;for(s in e)if(!(i&&"default"===s||t[s]))return!1;return!0}(A,b?S:S.default.locals,b)?(A=b?S:S.default.locals,m(S.default)):t.hot.invalidate()}))}t.hot.dispose((function(){m()}));const T=S.default&&S.default.locals?S.default.locals:void 0}}]);